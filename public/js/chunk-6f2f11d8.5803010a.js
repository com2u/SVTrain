(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f2f11d8"],{"1fd3":function(e,n,t){"use strict";var a=t("1da1"),s=t("5530"),r=(t("96cf"),t("99af"),t("ac1f"),t("1276"),t("00b4"),t("d3b7"),t("159b"),t("b64b"),t("2f62")),o=t("bc3a"),i=t.n(o),c=t("ed08"),l=t("7c15"),u=t("29b2");n["a"]={data:function(){return{isLoading:{statistic:!1,train:!1,test:!1,validate:!1,export:!1,stop:!1,ExportImages:!1},logs:{training:{},test:{},validate:{},export_model:null,export_results:null,export_images:null},running:null,workspace:null,checkInterval:750,commands:[],twoLogLines:null,status:null,aiOptions:{}}},computed:Object(s["a"])({},Object(r["b"])(["currentWs"])),methods:{openLogsFor:function(e){window.open("/logs/".concat(e,"?sessionToken=").concat(localStorage.getItem("sessionToken")))},checkStatus:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,l["a"].getRunningState();case 2:e.running=n.sent;case 3:case"end":return n.stop()}}),n)})))()},checkWorkspace:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,l["a"].getWorkspace();case 2:e.workspace=n.sent,console.log("Workspace: ".concat(e.workspace));case 4:case"end":return n.stop()}}),n)})))()},runCommand:function(e){var n=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n.isLoading[e]=!0,t.prev=1,t.next=4,l["a"].runCommand(e);case 4:return t.next=6,n.checkStatus();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.log(t.t0);case 11:n.isLoading[e]=!1;case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))()}},created:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=e.currentWs.split("/").pop(),n.next=3,i.a.get("".concat(Object(c["b"])()).concat(t,"/TFSettings.json")).then((function(n){var t=n.data;e.aiOptions=t}));case 3:return e.sessionUser=localStorage.getItem("sessionUser"),n.next=6,e.checkStatus();case 6:return n.next=8,e.checkWorkspace();case 8:return n.next=10,l["a"].getLastLogs();case 10:e.logs=n.sent,u["a"].subscibeForFolder("lock.txt",(function(n){"unlink"===n.event&&(e.running=!1),"change"===n.event&&(e.running=n.content),e.isLoading.train=Boolean(e.running),e.isLoading.test=Boolean(e.running),e.isLoading.validate=Boolean(e.running)})),u["a"].subscibeForFolder("workspace.bat",(function(n){"unlink"===n.event&&(e.workspace=!1),"change"===n.event&&(e.workspace=n.content)})),u["a"].subscribe("logfile",(function(n){n.forEach((function(n){n&&e.logs[n.file]&&(e.logs[n.file].lastLine=n.lastLine)}))})),u["a"].subscribe("exportFile",(function(n){Object.keys(n).forEach((function(t){e.logs[t]=n[t]}))})),u["a"].subscribe("lock.txt",(function(n){"unlink"===n.event&&(e.running=!1),"change"===n.event&&(e.running=n.content)})),u["a"].subscribe("workspace.bat",(function(n){"unlink"===n.event&&(e.workspace=!1),"change"===n.event&&(e.workspace=n.content)})),u["a"].subscribe("zipDone",(function(n){e.logs[n.field]=n.path}));case 18:case"end":return n.stop()}}),n)})))()},beforeDestroy:function(){return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:u["a"].unsubscribeForFolder("lock.txt"),u["a"].unsubscribeForFolder("workspace.bat");case 2:case"end":return e.stop()}}),e)})))()}}},"31fa":function(e,n,t){"use strict";t.r(n);var a=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"container-fluid"},[e._m(0),t("div",{staticClass:"cmd-main-menu"},[t("div",[e._v("Workspace: "),t("strong",[e._v(e._s(e.currentWs))])]),null!==e.running?t("div",{domProps:{innerHTML:e._s(e.running||"idle")}}):t("b",[e._v("no info")]),e._l(e.commands,(function(n){return[e.aiOptions[n.value]?t("div",{key:n.value,staticClass:"cmd"},[t("b-button",{staticClass:"svtrain-cmd-btn",class:"script_stop_validate"===n.value?"btn-stop-command":"btn-command",attrs:{disabled:!!e.isLoading[n.value]||"script_stop_validate"===n.value&&!e.running||"script_stop_validate"!==n.value&&!!e.running},on:{click:function(t){return e.runCommand(n.value,e.workspace)}}},[n.icon?t("svg-icon",{attrs:{"icon-class":n.icon}}):t("v-icon",{attrs:{name:"script_stop_validate"===n.value?"stop":"play"}}),t("span",{staticClass:"ml-2"},[e._v(e._s(n.label))])],1),n.btn&&![null,void 0].includes(e.logs[n.btn])?t("b-button",{staticClass:"ml-2",attrs:{variant:"light"},on:{click:function(t){return e.downloadExport(n.btn)}}},["string"===typeof e.logs[n.btn]?t("span",[e._v("Download")]):t("span",{staticClass:"ml-2"},[e._v("Zipping")])]):e._e(),e.isLoading[n.value]?t("span",{staticClass:"ml-2"},[e._v("Running...")]):e._e(),e.logs[n.value]&&e.logs[n.value].lastLine?t("pre",{staticClass:"log-line",staticStyle:{"padding-left":"10px"},domProps:{innerHTML:e._s(e.logs[n.value].lastLine)},on:{click:function(t){return e.openLogsFor(n.value)}}}):e._e(),e._v(" "),t("div",{staticStyle:{clear:"both"}})],1):e._e()]})),t("pre",{staticClass:"py-4",domProps:{innerHTML:e._s(e.logs.validate.lastLine)}})],2)])},s=[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"title-container"},[t("div",[t("h4",[e._v("SVTrain")])])])}],r=(t("99af"),t("ed08")),o=t("1fd3"),i={name:"Validate",mixins:[o["a"]],data:function(){return{commands:[{value:"script_validate",label:"Run validate batch"},{value:"script_stop_validate",label:"Stop running validate"},{value:"script_export_model",label:"Run export model",btn:"export_model",icon:"export"},{value:"script_export_result",label:"Run export results",btn:"export_results",icon:"export"},{value:"script_export_image",label:"Run export images",btn:"export_images",icon:"ExportImage"},{value:"script_report",label:"Report",icon:"report"},{value:"script_validate2",label:"Backup",icon:"save"}]}},methods:{downloadExport:function(e){if(1!==this.logs[e]){var n="".concat(Object(r["d"])()?"":"http://127.0.0.1:3333","/data/").concat(this.logs[e],"?sessionToken=").concat(localStorage.getItem("sessionToken"),"&is_export=true&field=").concat(e),t=document.createElement("a");t.href=n,t.setAttribute("download","".concat(e).concat("export_images"===e?".zip":"")),document.body.appendChild(t),t.click()}}}},c=i,l=t("2877"),u=Object(l["a"])(c,a,s,!1,null,null,null);n["default"]=u.exports}}]);
//# sourceMappingURL=chunk-6f2f11d8.5803010a.js.map